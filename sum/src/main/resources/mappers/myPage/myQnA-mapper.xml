<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.kh.sum.myPage.model.mapper.MyQnAMapper">
	<sql id="myQnAListSql">
		SELECT  Q.QNA_NO, 
		        Q.QNA_TITLE, 
		        Q.QNA_CONTENT, 
		        Q.STATUS, 
		        Q.MEMBER_NO, 
		        Q.ANSWER_STATUS, 
		        Q.CREATE_DATE
		FROM QNA Q
		JOIN MEMBER M ON(Q.MEMBER_NO = M.MEMBER_NO)
		WHERE Q.STATUS = 'Y'
	</sql>
	
	<resultMap type="MyQnA" id="myQnAListResultMap">
		<id property="no" column="QNA_NO"/>
		<result property="title" column="QNA_TITLE"/>
		<result property="content" column="QNA_CONTENT"/>
		<result property="status" column="STATUS"/>
		<result property="memberNo" column="MEMBER_NO"/>
		<result property="answerStatus" column="ANSWER_STATUS"/>
		<result property="createDate" column="CREATE_DATE"/>
	</resultMap>

    <!-- 게시글 목록 조회(전체 목록) -->
	<select id="selectMyQnACount" resultType="_int">
		SELECT COUNT(*) FROM QNA WHERE STATUS='Y'
	</select>

	<select id="selectAll" resultMap="myQnAListResultMap">
		<include refid="myQnAListSql" />
		ORDER BY Q.QNA_NO DESC
	</select>
	
	<!-- QnA 등록 -->
	<insert id="insertQnA" parameterType="MyQnA"
			useGeneratedKeys="true" keyColumn="QNA_NO" keyProperty="qnaNo">
		INSERT INTO QNA (
			Q.QNA_NO,
			Q.QNA_TITLE,
			Q.QNA_CONTENT,
			Q.STATUS,
			Q.MEMBER_NO,
			Q.ANSWER_STATUS,
			Q.CREATE_DATE
		)
		VALUES(
			SEQ_QNA_NO.NEXTVAL,
			#{title},
			#{content},
			DEFAULT,
			#{memberNo},
			DEFAULT,
			DEFAULT
		)
		FROM QNA Q
		JOIN MEMBER M ON(Q.MEMBER_NO = M.MEMBER_NO)
		WHERE Q.STATUS = 'Y'
	</insert>
	
	
</mapper>
